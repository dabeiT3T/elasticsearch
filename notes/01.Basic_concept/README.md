## Basic concept

  ### 集群（cluster）

一个 Elasticsearch 集群由一个或多个 Elasticsearch 节点组成，所有节点共同存储数据。每个集群都应有一个唯一的集群名（ClusterName），同一环境内如果存在同名集群，可能会出现不可知异常。

### 节点（node）

一个节点是集群中的一个服务器，用来存储数据并参与集群的索引和搜索。一个集群可以拥有多个节点，每个节点可以扮演不同的角色：

- 数据节点

  存储索引数据的节点，主要对文档进行增删改查、聚合等操作。

- 专有主节点

  对集群进行操作，例如创建或删除索引，跟踪哪些节点是集群的一部分，并决定哪些分片分配给相关的节点。稳定的主节点对集群的健康非常重要，默认状况下集群中的任一节点都可能被选为主节点。

- 协调节点

  分担数据节点的 CPU 开销，从而提高处理性能和服务稳定性。

### 索引（index）

一个索引是一个拥有一些相似特征的文档的集合，相当于关系型数据库中的数据库。例如，你可以拥有一个客户数据的索引，一个商品目录的索引，以及一个订单数据的索引。一个索引通常使用一个名称（所有字母必须小写）来标识，当针对这个索引的文档执行索引、搜索、更新和删除操作的时候，这个名称被用来指向索引。

### 类型（type）

一个类型通常是一个索引的一个逻辑分类或分区，允许在一个索引下存储不同类型的文档，相当于关系型数据库中的一张表，例如用户类型、博客类型等。由于 `6.x` 以后的 Elasticsearch 版本已经不支持在一个索引下创建多个类型，因此类型概念在后续版本中不再被提及。

Elasticsearch `5.x` 允许在一个索引下存储不同类型的文档，Elasticsearch `6.x` 在一个索引下只允许一个类型，Elasticsearch `7.x` 索引类型命名只允许 `_doc`。

### 文档（document）

一个文档是可以被索引的基本信息单元，相当于关系数据库中的一行数据。例如，可以为一个客户创建一个文档，或者为一个商品创建一个文档。文档可以用 `JSON` 格式来表示。在一个索引中，可以存储任意多的文档，且文档必须被索引。

### 字段（field）

字段是组成文档的最小单位，相当于关系型数据库中的一列数据。

### 映射（mapping）

映射用来定义一个文档以及其所包含的字段如何被存储和索引，相当于关系型数据库中的 `Schema`，例如在映射中定义字段的名称和类型，以及所使用的分词器。

### Elasticsearch 与关系型数据库的映射关系如下：

| Elasticsearch    | 关系型数据库                 |
| ---------------- | ---------------------------- |
| 索引（index）    | 数据库（Database）           |
| 文档类型（type） | 表（Table）                  |
| 文档（document） | 一行数据（Row）              |
| 字段（field）    | 一列数据（Column）           |
| 映射（mapping）  | 数据库的组织和结构（Schema） |

### 分片（shards）

`shards` 代表索引分片，Elasticsearch 可以把一个完整的索引分成多个分片，这样的好处是可以把一个大的索引拆分成多个，分布到不同的节点上，构成分布式搜索。分片的数量只能在索引创建前指定，并且索引创建后不能更改。

### 副本（replicas）

副本是索引的备份，Elasticsearch 可以设置多个副本。写操作会先在主分片上完成，然后分发到副本分片上。因为索引的主分片和副本分片都可以对外提供查询服务，所以副本能够提升系统的高可用性和搜索时的并发性能。但如果副本太多，也会增加写操作时数据同步的负担。

Elasticsearch `7.0` 以下版本默认为一个索引创建 5 个主分片，并分别为每个主分片创建 1 个副本分片，`7.0` 及以上版本默认为一个索引创建 1 个主分片和 1 个副本分片。两者区别如下：

| 分片类型 | 支持处理的请求                         | 数量是否可修改                     | 其他说明                                                     |
| -------- | -------------------------------------- | ---------------------------------- | ------------------------------------------------------------ |
| 主分片   | 支持处理查询和索引请求。               | 在创建索引时设定，设定后不可更改。 | 索引内任意一个文档都存储在一个主分片中，所以主分片的数量决定着索引能够保存的最大数据量。 |
| 副本分片 | 支持处理查询请求，不支持处理索引请求。 | 可在任何时候添加或删除副本分片。   | 副本分片对搜索性能非常重要。提高系统的容错性能，当某个节点某个分片损坏或丢失时可以从副本中恢复；提高 Elasticsearch 的查询效率，自动对搜索请求进行负载均衡。 |

### gateway

`gateway` 代表 Elasticsearch 索引快照的存储方式，默认优先将索引存放到内存中，当内存满时再将这些索引持久化存储至本地硬盘。`gateway` 对索引快照进行存储，当这个 Elasticsearch 集群关闭再重新启动时就会从 `gateway` 中读取索引备份数据。Elasticsearch 支持多种类型的 `gateway`，有本地文件系统（默认）、分布式文件系统、Hadoop 的 HDFS。

### discovery.zen

`discovery.zen` 代表 Elasticsearch 的自动发现节点机制，Elasticsearch 是一个基于 P2P 的系统，它先通过广播寻找存在的节点，再通过多播协议进行节点之间的通信，同时也支持点对点的交互。

### Transport

`Transport` 代表 Elasticsearch 内部节点或集群与客户端的交互方式，默认使用 TCP 协议进行交互。同时支持通过插件的方式集成，因此也可以使用 HTTP 协议（JSON 格式）、thrift、servlet、memcache、zeroMQ 等传输协议进行交互。

### X-Pack

X-Pack 是 elasticsearch 的一个商业版扩展包，包含安全 Security、警告 Altering、监控 Monitoring、图形 Graph 和报告 Reporting、机器学习 MachineLearning 等多种高级功能。

### Beats

Beats 是轻量级的数据采集工具，集合了多种单一用途的数据采集器。它们从成百上千或成千上万台机器和系统向 Logstash 或 Elasticsearch 发送数据。

### Logstash

Logstash 作为服务器端的数据处理管道，通过输入、过滤和输出插件，动态地从多个来源采集数据，并加工和转换成任何类型的事件，最终将数据存储到所选择的位置。

### Kibana

Kibana 是灵活的数据分析和可视化工具，支持多用户登录。在 Kibana 中，可以搜索和查看 Elasticsearch 索引中的数据，并进行交互。
