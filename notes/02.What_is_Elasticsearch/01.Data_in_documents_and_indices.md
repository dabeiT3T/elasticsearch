## Data in: documents and indices

`es` 将复杂的数据结构序列化成 `JSON` 文档，而不是将信息存储为列数据行。当集群中有多个 `es` 节点时，存储的文档分布在整个集群中，可以快速地访问任意节点。

`es` 使用一种称为倒排索引（inverted index）的数据结构，支持非常快速的全文搜索。倒排索引列出了文档中每一个唯一的单词，并标识出每个单词所出现在其中的所有文档。

 索引可以看作是文档的优化集合，每个文档是字段的集合，字段是键值对的形式包含着数据。默认情况下，`es` 对每个字段中的所有数据建立索引，每个字段索引使用专门的、优化的数据结构。例如，文本字段通过倒排索引存储，数字和地理字段存储在 BKD 树中。

`es` 支持不显式指定索引方式。通过启用动态映射，`es` 会自动检测并为新字段添加索引。`es` 会检测布尔值、浮点数、整型、日期和字符串并将其映射至适当的数据类型（索引）。

但是人为定义映射有以下好处：

- 区分全文（索引）字符串字段和精确（匹配）字符串字段；
- 执行特定于语言的文本分析；
- 优化字段实现部分匹配；
- 使用自定义日期格式；
- 无法自动检测出例如 `geo_point` 和 `geo_shape` 的数据格式；

甚至可以为了不同的目的对相同的字段添加不同的索引方式；例如，索引一个字符串字段，既作为全文搜索的文本字段，又作为排序或聚合数据的关键字字段。使用多种语言的分析器来处理包含用户输入的字符串字段的内容。

在建立全文索引时所使用的分析链也会在搜索时使用。在查询全文字段时，查询的文本也需要经历同样的（索引）分析链分析后再在索引中搜索。也就是说查询的文本也需要先被分词处理等。
